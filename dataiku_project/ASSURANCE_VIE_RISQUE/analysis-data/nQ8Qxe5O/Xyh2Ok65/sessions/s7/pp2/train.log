[2025/08/19-21:14:01.546] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.analysis.prediction]  - [ct: 0] ******************************************
[2025/08/19-21:14:01.567] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.analysis.prediction]  - [ct: 21] ** Start train session s7
[2025/08/19-21:14:01.583] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.analysis.prediction]  - [ct: 37] ******************************************
[2025/08/19-21:14:01.601] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.shaker.data] T-Xyh2Ok65 - [ct: 55] Need to compute sampleId before checking memory cache
[2025/08/19-21:14:01.618] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dip.shaker.runner] T-Xyh2Ok65 - [ct: 72] Script settings sampleMax=104857600 processedMax=-1
[2025/08/19-21:14:01.639] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dip.shaker.runner] T-Xyh2Ok65 - [ct: 93] Processing with sampleMax=104857600 processedMax=524288000
[2025/08/19-21:14:01.655] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dip.shaker.runner] T-Xyh2Ok65 - [ct: 109] Computed required sample id : 6c00a9e3cd393d81d3ac200abb6e8467-NA-67d2d4a7bb9f68bd5a120c6956099c590--d751713988987e9331980363e24189ce
[2025/08/19-21:14:01.669] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.shaker.cache] T-Xyh2Ok65 - Shaker MemoryCache get on dataset ASSURANCE_VIE_RISQUE.montant_investi key=ds=cd99c27b56e5b06270123181a98e1926--scr=2ebeb8020262c50b5f030ec612606648--samp=6c00a9e3cd393d81d3ac200abb6e8467-NA-67d2d4a7bb9f68bd5a120c6956099c590--d751713988987e9331980363e24189ce: hit
[2025/08/19-21:14:01.680] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.shaker.schema] T-Xyh2Ok65 - [ct: 134] Column client_id meaning=LongMeaning fail=0
[2025/08/19-21:14:01.691] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.shaker.schema] T-Xyh2Ok65 - [ct: 145] Column nom meaning=Text fail=0
[2025/08/19-21:14:01.704] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.shaker.schema] T-Xyh2Ok65 - [ct: 158] Column prenom meaning=Text fail=0
[2025/08/19-21:14:01.714] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.shaker.schema] T-Xyh2Ok65 - [ct: 168] Column nbre_contrat_investi meaning=LongMeaning fail=0
[2025/08/19-21:14:01.727] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.shaker.schema] T-Xyh2Ok65 - [ct: 181] Column total_investi meaning=DoubleMeaning fail=0
[2025/08/19-21:14:01.739] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.shaker.schema] T-Xyh2Ok65 - [ct: 193] Column rang_investisseur meaning=LongMeaning fail=0
[2025/08/19-21:14:01.752] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.input.push] T-Xyh2Ok65 - Using ordering from dataset: {"enabled":false,"rules":[]}
[2025/08/19-21:14:01.764] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.input.push] T-Xyh2Ok65 - USTP: push selection.method=HEAD_SEQUENTIAL records=100000 ratio=0.02 col=null
[2025/08/19-21:14:01.778] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.push] T-Xyh2Ok65 - [ct: 232] Push row splits limit= {"maxBytes":-1,"maxRecords":100000,"samplingMethod":"HEAD_SEQUENTIAL","samplingRatio":0.02,"ordering":{"enabled":false,"rules":[]}}
[2025/08/19-21:14:01.800] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.input.rows] T-Xyh2Ok65 - [ct: 254] Starting to push split com.dataiku.dip.datasets.sql.AbstractSQLTableDatasetHandler$TableClauseSplit@17375e9c with limit= 100000
[2025/08/19-21:14:01.822] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 276] Connecting to jdbc:mysql://localhost:3306/assurance_vie with props: {"useInformationSchema":"true","password":"***","rewriteBatchedStatements":"true","useOldAliasMetadataBehavior":"true","zeroDateTimeBehavior":"convertToNull","useLegacyDatetimeCode":"false","user":"root","useServerPrepStmts":"false"} conn=assurance_vie-j9kSfJG
[2025/08/19-21:14:01.836] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.connections.sql.driver] T-Xyh2Ok65 - Driver version 9.3
[2025/08/19-21:14:01.854] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.sql.connection.service.factory] T-Xyh2Ok65 - [ct: 308] SQL connection pool disabled (globally or for the connection)
[2025/08/19-21:14:01.902] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 356] Driver: MySQL Connector/J (JDBC 4.2) mysql-connector-j-9.3.0 (Revision: 20ef8ee9eb4294a03858acccea0ddad3525f1ff9) (9.3)
[2025/08/19-21:14:01.920] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 374] Database: MySQL 9.3.0 (9.3) rowSize=2147483639 stmts=0
[2025/08/19-21:14:01.932] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.resourceusage] T-Xyh2Ok65 - [ct: 386] Reporting start of CRU:{"type":"SQL_CONNECTION","id":"vFhl90oDZxNavTOk","startTime":1755630841902,"sqlConnection":{"connection":"assurance_vie"}}
[2025/08/19-21:14:01.947] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.resourceusage] T-Xyh2Ok65 - [ct: 401] Reporting start of CRU:{"type":"SQL_QUERY","id":"ou4PGweJ0LLqZMmg","startTime":1755630841947,"sqlQuery":{"connectionUsageId":"vFhl90oDZxNavTOk","connection":"assurance_vie","query":"SELECT *\n  FROM `ASSURANCE_VIE_RISQUE_montant_investi`\n  LIMIT 100000"}}
[2025/08/19-21:14:01.962] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.sql] T-Xyh2Ok65 - [ct: 416] SET MAX ROWS 100000
[2025/08/19-21:14:01.977] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.sql] T-Xyh2Ok65 - [ct: 431] Executing query SELECT *
  FROM `ASSURANCE_VIE_RISQUE_montant_investi`
  LIMIT 100000 (st=com.mysql.cj.jdbc.StatementImpl@5e981aa5)
[2025/08/19-21:14:01.998] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.sql] T-Xyh2Ok65 - [ct: 452] Done executing query (st=com.mysql.cj.jdbc.StatementImpl@5e981aa5) time=21
[2025/08/19-21:14:02.013] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.sql] T-Xyh2Ok65 - [ct: 467] Done iterating result set, returned 346 rows
[2025/08/19-21:14:02.028] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.resourceusage] T-Xyh2Ok65 - [ct: 482] Reporting completion of CRU:{"type":"SQL_QUERY","id":"ou4PGweJ0LLqZMmg","startTime":1755630841947,"sqlQuery":{"connectionUsageId":"vFhl90oDZxNavTOk","connection":"assurance_vie","query":"SELECT *\n  FROM `ASSURANCE_VIE_RISQUE_montant_investi`\n  LIMIT 100000","fetchedRowCount":346,"statementExecutionTime":21}}
[2025/08/19-21:14:02.043] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.sql] T-Xyh2Ok65 - [ct: 497] Exited push
[2025/08/19-21:14:02.059] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 513] Rollback and close conn=assurance_vie-j9kSfJG
[2025/08/19-21:14:02.076] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 530] Rollback conn=assurance_vie-j9kSfJG
[2025/08/19-21:14:02.093] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 547] Close conn=assurance_vie-j9kSfJG
[2025/08/19-21:14:02.110] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 564] Close conn=assurance_vie-j9kSfJG
[2025/08/19-21:14:02.124] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.resourceusage] T-Xyh2Ok65 - [ct: 578] Reporting completion of CRU:{"type":"SQL_CONNECTION","id":"vFhl90oDZxNavTOk","startTime":1755630841902,"sqlConnection":{"connection":"assurance_vie"}}
[2025/08/19-21:14:02.141] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.input.rows] T-Xyh2Ok65 - [ct: 595] After split com.dataiku.dip.datasets.sql.AbstractSQLTableDatasetHandler$TableClauseSplit@17375e9c, still have 99654 to push
[2025/08/19-21:14:02.159] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.input.push] T-Xyh2Ok65 - Using ordering from dataset: {"enabled":false,"rules":[]}
[2025/08/19-21:14:02.178] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.input.push] T-Xyh2Ok65 - USTP: push selection.method=HEAD_SEQUENTIAL records=100000 ratio=0.02 col=null
[2025/08/19-21:14:02.199] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.push] T-Xyh2Ok65 - [ct: 653] Push row splits limit= {"maxBytes":-1,"maxRecords":100000,"samplingMethod":"HEAD_SEQUENTIAL","samplingRatio":0.02,"ordering":{"enabled":false,"rules":[]}}
[2025/08/19-21:14:02.216] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.input.rows] T-Xyh2Ok65 - [ct: 670] Starting to push split com.dataiku.dip.datasets.sql.AbstractSQLTableDatasetHandler$TableClauseSplit@46dff3c with limit= 100000
[2025/08/19-21:14:02.231] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 685] Connecting to jdbc:mysql://localhost:3306/assurance_vie with props: {"useInformationSchema":"true","password":"***","rewriteBatchedStatements":"true","useOldAliasMetadataBehavior":"true","zeroDateTimeBehavior":"convertToNull","useLegacyDatetimeCode":"false","user":"root","useServerPrepStmts":"false"} conn=assurance_vie-inlmESb
[2025/08/19-21:14:02.245] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.connections.sql.driver] T-Xyh2Ok65 - Driver version 9.3
[2025/08/19-21:14:02.257] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.sql.connection.service.factory] T-Xyh2Ok65 - [ct: 711] SQL connection pool disabled (globally or for the connection)
[2025/08/19-21:14:02.292] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 746] Driver: MySQL Connector/J (JDBC 4.2) mysql-connector-j-9.3.0 (Revision: 20ef8ee9eb4294a03858acccea0ddad3525f1ff9) (9.3)
[2025/08/19-21:14:02.306] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 760] Database: MySQL 9.3.0 (9.3) rowSize=2147483639 stmts=0
[2025/08/19-21:14:02.318] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.resourceusage] T-Xyh2Ok65 - [ct: 772] Reporting start of CRU:{"type":"SQL_CONNECTION","id":"13gmZndAIk9ZEVDT","startTime":1755630842292,"sqlConnection":{"connection":"assurance_vie"}}
[2025/08/19-21:14:02.334] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.resourceusage] T-Xyh2Ok65 - [ct: 788] Reporting start of CRU:{"type":"SQL_QUERY","id":"tNV7ZwNlhgGXXI46","startTime":1755630842334,"sqlQuery":{"connectionUsageId":"13gmZndAIk9ZEVDT","connection":"assurance_vie","query":"SELECT *\n  FROM `ASSURANCE_VIE_RISQUE_montant_investi`\n  LIMIT 100000"}}
[2025/08/19-21:14:02.349] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.sql] T-Xyh2Ok65 - [ct: 803] SET MAX ROWS 100000
[2025/08/19-21:14:02.366] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.sql] T-Xyh2Ok65 - [ct: 820] Executing query SELECT *
  FROM `ASSURANCE_VIE_RISQUE_montant_investi`
  LIMIT 100000 (st=com.mysql.cj.jdbc.StatementImpl@1929e893)
[2025/08/19-21:14:02.388] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.sql] T-Xyh2Ok65 - [ct: 842] Done executing query (st=com.mysql.cj.jdbc.StatementImpl@1929e893) time=22
[2025/08/19-21:14:02.409] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.sql] T-Xyh2Ok65 - [ct: 863] Done iterating result set, returned 346 rows
[2025/08/19-21:14:02.423] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.resourceusage] T-Xyh2Ok65 - [ct: 877] Reporting completion of CRU:{"type":"SQL_QUERY","id":"tNV7ZwNlhgGXXI46","startTime":1755630842334,"sqlQuery":{"connectionUsageId":"13gmZndAIk9ZEVDT","connection":"assurance_vie","query":"SELECT *\n  FROM `ASSURANCE_VIE_RISQUE_montant_investi`\n  LIMIT 100000","fetchedRowCount":346,"statementExecutionTime":22}}
[2025/08/19-21:14:02.435] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.datasets.sql] T-Xyh2Ok65 - [ct: 889] Exited push
[2025/08/19-21:14:02.449] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 903] Rollback and close conn=assurance_vie-inlmESb
[2025/08/19-21:14:02.464] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 918] Rollback conn=assurance_vie-inlmESb
[2025/08/19-21:14:02.480] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 934] Close conn=assurance_vie-inlmESb
[2025/08/19-21:14:02.498] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.connections.sql.provider] T-Xyh2Ok65 - [ct: 952] Close conn=assurance_vie-inlmESb
[2025/08/19-21:14:02.515] [FT-TrainWorkThread-V7M0TlMq-11133] [DEBUG] [dku.resourceusage] T-Xyh2Ok65 - [ct: 969] Reporting completion of CRU:{"type":"SQL_CONNECTION","id":"13gmZndAIk9ZEVDT","startTime":1755630842292,"sqlConnection":{"connection":"assurance_vie"}}
[2025/08/19-21:14:02.537] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.input.rows] T-Xyh2Ok65 - [ct: 991] After split com.dataiku.dip.datasets.sql.AbstractSQLTableDatasetHandler$TableClauseSplit@46dff3c, still have 99654 to push
[2025/08/19-21:14:02.565] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.analysis.splits] T-Xyh2Ok65 - [ct: 1019] Checking if splits are up to date. Policy: type=EXPLICIT_FILTERING_SINGLE_DATASET,dataset=null,trainSel=method=head-s,records=100000,trainFilter=null,testSel=method=head-s,records=100000,testFilter=disabled, instance id: b2e655b148b8f187f98b4330e72e3e72-0
[2025/08/19-21:14:02.629] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.analysis.ml.python] T-Xyh2Ok65 - [ct: 1083] Joining processing thread ...
[2025/08/19-21:14:02.629] [MRT-11135] [INFO] [dku.analysis.ml.python]  - Running a preprocessing set: pp2 in C:\Users\Admin\AppData\Local\Dataiku\DataScienceStudio\dss_home\analysis-data\ASSURANCE_VIE_RISQUE\nQ8Qxe5O\Xyh2Ok65\sessions\s7\pp2
[2025/08/19-21:14:02.663] [MRT-11135] [INFO] [dku.block.link]  - Started a socket on port 51668
[2025/08/19-21:14:02.683] [MRT-11135] [INFO] [com.dataiku.dip.analysis.ml.distributed.workers]  - New worker pool created: pool-tzy68l5gdgyakb5v
[2025/08/19-21:14:02.701] [MRT-11135] [INFO] [dku.ml.kernel]  - Writing output of python-single-command-kernel to C:\Users\Admin\AppData\Local\Dataiku\DataScienceStudio\dss_home\analysis-data\ASSURANCE_VIE_RISQUE\nQ8Qxe5O\Xyh2Ok65\sessions\s7\pp2\train.log
[2025/08/19-21:14:02.711] [MRT-11135] [INFO] [dku.code.envs.resolution]  - Executing Python activity in builtin env
[2025/08/19-21:14:02.739] [MRT-11135] [INFO] [dku.python.kernel]  - Starting Python process for kernel  python-single-command-kernel
[2025/08/19-21:14:02.749] [MRT-11135] [INFO] [dip.tickets]  - Creating API ticket for analysis-ml-ASSURANCE_VIE_RISQUE-Q87Q7vz on behalf of admin id=analysis-ml-ASSURANCE_VIE_RISQUE-Q87Q7vz_nYB9T2961U3f
[2025/08/19-21:14:02.769] [MRT-11135] [INFO] [dku.process]  - Starting process (regular)
[2025/08/19-21:14:02.799] [MRT-11135] [INFO] [dku.process]  - Process started with pid=17352
[2025/08/19-21:14:02.825] [KNL-python-single-command-kernel-monitor-11140] [DEBUG] [dku.resourceusage]  - Reporting start of CRU:{"context":{"type":"ANALYSIS_ML_TRAIN","authIdentifier":"admin","projectKey":"ASSURANCE_VIE_RISQUE","analysisId":"nQ8Qxe5O","mlTaskId":"Xyh2Ok65","sessionId":"s7"},"type":"LOCAL_PROCESS","id":"oiU3zdwAjw70Z9IY","startTime":1755630842824,"localProcess":{"cpuCurrent":0.0,"cpuAverageOverPast60Seconds":0.0}}
[2025/08/19-21:14:02.849] [process-resource-monitor-17352-11142] [DEBUG] [dku.resource]  - Process stats for pid 17352: {"pid":17352,"commandName":"C:\\Users\\Admin\\AppData\\Local\\Dataiku\\DataScienceStudio\\dss_home\\pyenv\\Scripts\\python.exe","cpuCurrent":0.0,"cpuAverageOverPast60Seconds":0.0,"vmRSSTotalMBS":0}
Skipping installation of debugging signal handler (Windows)
[2025-08-19 21:14:11,442] [11384/MainThread] [INFO] [dataiku.base.socket_block_link] no cert found
[2025-08-19 21:14:11,450] [11384/MainThread] [INFO] [dataiku.base.socket_block_link] Connecting to localhost (127.0.0.1) at port 51668
[2025-08-19 21:14:11,453] [11384/MainThread] [INFO] [dataiku.base.socket_block_link] Connected to localhost (127.0.0.1) at port 51668
[2025/08/19-21:14:11.453] [MRT-11135] [INFO] [dku.link.secret_protected]  - Connected to kernel
[2025/08/19-21:14:11.476] [MRT-11135] [INFO] [dku.block.link.interaction]  - Execute link command respClazz=true respTypeToken=false respIsString=false is=false asyncInputStream=false os=false
C:\Users\Admin\AppData\Local\Dataiku\DataScienceStudio\kits\dataiku-dss-14.1.0-win\python\dataiku\doctor\posttraining\features_distribution.py:18: DeprecationWarning: Please import `mquantiles` from the `scipy.stats.mstats` namespace; the `scipy.stats.mstats_basic` namespace is deprecated and will be removed in SciPy 2.0.0.
  from scipy.stats.mstats_basic import mquantiles
[2025-08-19 21:14:12,625] [11384/MainThread] [INFO] [__main__] Running analysis command: train_prediction_models_nosave
[2025-08-19 21:14:12,626] [11384/MainThread] [INFO] [dataiku.doctor.utils.gpu_execution] Not logging `nvidia-smi`: `useGPU` is False
[2025-08-19 21:14:12,627] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] enabling diagnostic callback: DatasetSanityCheckDiagnostic of type DiagnosticType.ML_DIAGNOSTICS_DATASET_SANITY_CHECKS
[2025-08-19 21:14:12,627] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] enabling diagnostic callback: ClassifierAccuracyCheckDiagnostic of type DiagnosticType.ML_DIAGNOSTICS_MODEL_CHECK
[2025-08-19 21:14:12,628] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] enabling diagnostic callback: RegressionR2CheckDiagnostic of type DiagnosticType.ML_DIAGNOSTICS_MODEL_CHECK
[2025-08-19 21:14:12,628] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] enabling diagnostic callback: LeakageDiagnostic of type DiagnosticType.ML_DIAGNOSTICS_LEAKAGE_DETECTION
[2025-08-19 21:14:12,628] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] enabling diagnostic callback: TreeOverfitDiagnostic of type DiagnosticType.ML_DIAGNOSTICS_TRAINING_OVERFIT
[2025-08-19 21:14:12,628] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] enabling diagnostic callback: MLAssertionsDiagnostic of type DiagnosticType.ML_DIAGNOSTICS_ML_ASSERTIONS
[2025-08-19 21:14:12,628] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] enabling diagnostic callback: ModelCheckDiagnostic of type DiagnosticType.ML_DIAGNOSTICS_MODEL_CHECK
[2025-08-19 21:14:12,629] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] enabling diagnostic callback: AbnormalPredictionsDetectionDiagnostic of type DiagnosticType.ML_DIAGNOSTICS_ABNORMAL_PREDICTIONS_DETECTION
[2025-08-19 21:14:12,629] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common] NaN support unavailable: incompatible algorithm DECISION_TREE_REGRESSION on scikit-learn==1.3.2
[2025-08-19 21:14:12,630] [11384/MainThread] [INFO] [dataiku.doctor.commands] PPS is {'feature_selection_params': {'method': 'NONE', 'random_forest_params': {'n_trees': 30, 'depth': 10, 'n_features': 25}, 'lasso_params': {'alpha': [0.01, 0.1, 1.0, 10.0, 100.0], 'cross_validate': True}, 'pca_params': {'n_features': 25, 'variance_proportion': 0.9}, 'correlation_params': {'min_abs_correlation': 0.0, 'max_abs_correlation': 1.0, 'n_features': 25}, 'custom_params': {'code': '# type your code here'}}, 'preprocessingFitSampleRatio': 1.0, 'preprocessingFitSampleSeed': 1337, 'target_remapping': [], 'skipPreprocessing': False, 'per_feature': {'total_investi': {'generate_derivative': False, 'impute_constant_value': 0.0, 'keep_regular': False, 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'TARGET', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'DoubleMeaning'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'rang_investisseur': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEDIAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'autoReason': 'REJECT_IDENTIFIER', 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'nom': {'category_handling': 'DUMMIFY', 'missing_handling': 'NONE', 'missing_impute_with': 'MODE', 'dummy_clip': 'MAX_NB_CATEGORIES', 'cumulative_proportion': 0.95, 'min_samples': 10, 'max_nb_categories': 100, 'max_cat_safety': 200, 'nb_bins_hashing': 1048576, 'hash_whole_categories': True, 'dummy_drop': 'NONE', 'impact_method': 'M_ESTIMATOR', 'impact_m': 10, 'impact_kfold': True, 'impact_kfold_k': 5, 'impact_kfold_seed': 1337, 'ordinal_order': 'COUNT', 'ordinal_ascending': False, 'ordinal_default_mode': 'HIGHEST', 'ordinal_default_value': 0, 'frequency_default_mode': 'EXPLICIT', 'frequency_default_value': 0.0, 'frequency_normalized': True, 'role': 'REJECT', 'type': 'CATEGORY', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'Text'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'prenom': {'category_handling': 'DUMMIFY', 'missing_handling': 'NONE', 'missing_impute_with': 'MODE', 'dummy_clip': 'MAX_NB_CATEGORIES', 'cumulative_proportion': 0.95, 'min_samples': 10, 'max_nb_categories': 100, 'max_cat_safety': 200, 'nb_bins_hashing': 1048576, 'hash_whole_categories': True, 'dummy_drop': 'NONE', 'impact_method': 'M_ESTIMATOR', 'impact_m': 10, 'impact_kfold': True, 'impact_kfold_k': 5, 'impact_kfold_seed': 1337, 'ordinal_order': 'COUNT', 'ordinal_ascending': False, 'ordinal_default_mode': 'HIGHEST', 'ordinal_default_value': 0, 'frequency_default_mode': 'EXPLICIT', 'frequency_default_value': 0.0, 'frequency_normalized': True, 'role': 'REJECT', 'type': 'CATEGORY', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'Text'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'client_id': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEDIAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'autoReason': 'REJECT_IDENTIFIER', 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'nbre_contrat_investi': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}}, 'reduce': {'enabled': False, 'kept_variance': 0.0}, 'feature_generation': {'pairwise_linear': {'behavior': 'DISABLED'}, 'polynomial_combinations': {'behavior': 'DISABLED'}, 'manual_interactions': {'interactions': [{'column_1': 'rang_investisseur', 'column_2': 'nbre_contrat_investi', 'max_features': 100, 'rescale': True}]}, 'numericals_clustering': {'k': 0, 'all_features': False, 'input_features': [], 'behavior': 'DISABLED'}, 'categoricals_count_transformer': {'all_features': False, 'input_features': [], 'behavior': 'DISABLED'}}}
[2025-08-19 21:14:12,630] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] START -  Loading train set
[2025-08-19 21:14:12,662] [11384/MainThread] [INFO] [dataiku.doctor.utils] Training on platform: {"architecture": ["64bit", "WindowsPE"], "libc": [], "machine": "AMD64", "kernelRelease": "10", "kernelVersion": "10.0.19045", "platform": "Windows-10-10.0.19045-SP0", "pythonCompiler": "MSC v.1943 64 bit (AMD64)", "pythonImplementation": "CPython", "pythonVersion": "3.11.11", "system": "Windows"}
[2025-08-19 21:14:12,662] [11384/MainThread] [INFO] [dataiku.doctor.utils] Training on CPU: {"errorReadingCPUInfo": "[Errno 2] No such file or directory: '/proc/cpuinfo'"}
[2025-08-19 21:14:12,916] [11384/MainThread] [INFO] [dataiku.doctor.utils] Training with main package versions: {"pandas": "2.2.3", "scikit-learn": "1.3.2", "scipy": "1.13.1", "lightgbm": "4.6.0", "flask": "2.2.5", "itsdangerous": "2.2.0", "jinja2": "3.1.6", "xgboost": "1.7.6", "werkzeug": "3.1.3", "statsmodels": "0.14.4", "pillow": "11.1.0", "markupsafe": "3.0.2", "cloudpickle": "1.5.0"} 
[2025-08-19 21:14:12,945] [11384/MainThread] [INFO] [root] Reading with dtypes: None
[2025-08-19 21:14:12,945] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for client_id: <class 'numpy.float64'> (schema_type=bigint feature_type=NUMERIC feature_role=INPUT)
[2025-08-19 21:14:12,945] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for nom: None (schema_type=string feature_type=CATEGORY feature_role=REJECT)
[2025-08-19 21:14:12,945] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for prenom: None (schema_type=string feature_type=CATEGORY feature_role=REJECT)
[2025-08-19 21:14:12,946] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for nbre_contrat_investi: <class 'numpy.float64'> (schema_type=bigint feature_type=NUMERIC feature_role=INPUT)
[2025-08-19 21:14:12,946] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for total_investi: <class 'numpy.float64'> (schema_type=double feature_type=NUMERIC feature_role=TARGET)
[2025-08-19 21:14:12,947] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for rang_investisseur: <class 'numpy.float64'> (schema_type=bigint feature_type=NUMERIC feature_role=INPUT)
[2025-08-19 21:14:12,947] [11384/MainThread] [INFO] [root] Reading with FIXED dtypes: {'client_id': <class 'numpy.float64'>, 'nbre_contrat_investi': <class 'numpy.float64'>, 'total_investi': <class 'numpy.float64'>, 'rang_investisseur': <class 'numpy.float64'>}
[2025-08-19 21:14:13,022] [11384/MainThread] [INFO] [root] Loaded table
[2025-08-19 21:14:13,023] [11384/MainThread] [INFO] [dataiku.doctor.utils] Coercion done
[2025-08-19 21:14:13,048] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] Adding diagnostic: <DoctorDiagnostic ML_DIAGNOSTICS_DATASET_SANITY_CHECKS: Training set might be too small (346 rows) for robust training>
[2025-08-19 21:14:13,049] [11384/MainThread] [INFO] [dataiku.doctor.utils.split] Loaded train df: shape=(346,6)
[2025-08-19 21:14:13,050] [11384/MainThread] [INFO] [dataiku.doctor.commands] Train col : client_id (float64)
[2025-08-19 21:14:13,053] [11384/MainThread] [INFO] [dataiku.doctor.commands] Train col : nom (object)
[2025-08-19 21:14:13,053] [11384/MainThread] [INFO] [dataiku.doctor.commands] Train col : prenom (object)
[2025-08-19 21:14:13,054] [11384/MainThread] [INFO] [dataiku.doctor.commands] Train col : nbre_contrat_investi (float64)
[2025-08-19 21:14:13,054] [11384/MainThread] [INFO] [dataiku.doctor.commands] Train col : total_investi (float64)
[2025-08-19 21:14:13,054] [11384/MainThread] [INFO] [dataiku.doctor.commands] Train col : rang_investisseur (float64)
[2025-08-19 21:14:13,054] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] END -  Loading train set
[2025-08-19 21:14:13,055] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] START -  Loading test set
[2025-08-19 21:14:13,104] [11384/MainThread] [INFO] [root] Reading with dtypes: None
[2025-08-19 21:14:13,104] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for client_id: <class 'numpy.float64'> (schema_type=bigint feature_type=NUMERIC feature_role=INPUT)
[2025-08-19 21:14:13,104] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for nom: None (schema_type=string feature_type=CATEGORY feature_role=REJECT)
[2025-08-19 21:14:13,104] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for prenom: None (schema_type=string feature_type=CATEGORY feature_role=REJECT)
[2025-08-19 21:14:13,105] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for nbre_contrat_investi: <class 'numpy.float64'> (schema_type=bigint feature_type=NUMERIC feature_role=INPUT)
[2025-08-19 21:14:13,105] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for total_investi: <class 'numpy.float64'> (schema_type=double feature_type=NUMERIC feature_role=TARGET)
[2025-08-19 21:14:13,105] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for rang_investisseur: <class 'numpy.float64'> (schema_type=bigint feature_type=NUMERIC feature_role=INPUT)
[2025-08-19 21:14:13,105] [11384/MainThread] [INFO] [root] Reading with FIXED dtypes: {'client_id': <class 'numpy.float64'>, 'nbre_contrat_investi': <class 'numpy.float64'>, 'total_investi': <class 'numpy.float64'>, 'rang_investisseur': <class 'numpy.float64'>}
[2025-08-19 21:14:13,114] [11384/MainThread] [INFO] [root] Loaded table
[2025-08-19 21:14:13,115] [11384/MainThread] [INFO] [dataiku.doctor.utils] Coercion done
[2025-08-19 21:14:13,115] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] Adding diagnostic: <DoctorDiagnostic ML_DIAGNOSTICS_DATASET_SANITY_CHECKS: Test set might be too small (346 rows) for reliable performance estimation>
[2025-08-19 21:14:13,120] [11384/MainThread] [INFO] [dataiku.doctor.utils.split] Loaded test df: shape=(346,6)
[2025-08-19 21:14:13,120] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] END -  Loading test set
[2025-08-19 21:14:13,120] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] START -  Collecting statistics
[2025-08-19 21:14:13,159] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_collector] Looking at total_investi... (type=NUMERIC)
[2025-08-19 21:14:13,160] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_collector] Looking at rang_investisseur... (type=NUMERIC)
[2025-08-19 21:14:13,160] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_collector] Checking series of type: float64 (isM8=False)
[2025-08-19 21:14:13,163] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_collector] Looking at nom... (type=CATEGORY)
[2025-08-19 21:14:13,163] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_collector] Looking at prenom... (type=CATEGORY)
[2025-08-19 21:14:13,164] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_collector] Looking at client_id... (type=NUMERIC)
[2025-08-19 21:14:13,164] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_collector] Checking series of type: float64 (isM8=False)
[2025-08-19 21:14:13,175] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_collector] Looking at nbre_contrat_investi... (type=NUMERIC)
[2025-08-19 21:14:13,175] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_collector] Checking series of type: float64 (isM8=False)
[2025-08-19 21:14:13,179] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] generating interactions
[2025-08-19 21:14:13,179] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] generating : rang_investisseur x nbre_contrat_investi
[2025-08-19 21:14:13,180] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] {'feature_selection_params': {'method': 'NONE', 'random_forest_params': {'n_trees': 30, 'depth': 10, 'n_features': 25}, 'lasso_params': {'alpha': [0.01, 0.1, 1.0, 10.0, 100.0], 'cross_validate': True}, 'pca_params': {'n_features': 25, 'variance_proportion': 0.9}, 'correlation_params': {'min_abs_correlation': 0.0, 'max_abs_correlation': 1.0, 'n_features': 25}, 'custom_params': {'code': '# type your code here'}}, 'preprocessingFitSampleRatio': 1.0, 'preprocessingFitSampleSeed': 1337, 'target_remapping': [], 'skipPreprocessing': False, 'per_feature': {'total_investi': {'generate_derivative': False, 'impute_constant_value': 0.0, 'keep_regular': False, 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'TARGET', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'DoubleMeaning'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'rang_investisseur': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEDIAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'autoReason': 'REJECT_IDENTIFIER', 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'nom': {'category_handling': 'DUMMIFY', 'missing_handling': 'NONE', 'missing_impute_with': 'MODE', 'dummy_clip': 'MAX_NB_CATEGORIES', 'cumulative_proportion': 0.95, 'min_samples': 10, 'max_nb_categories': 100, 'max_cat_safety': 200, 'nb_bins_hashing': 1048576, 'hash_whole_categories': True, 'dummy_drop': 'NONE', 'impact_method': 'M_ESTIMATOR', 'impact_m': 10, 'impact_kfold': True, 'impact_kfold_k': 5, 'impact_kfold_seed': 1337, 'ordinal_order': 'COUNT', 'ordinal_ascending': False, 'ordinal_default_mode': 'HIGHEST', 'ordinal_default_value': 0, 'frequency_default_mode': 'EXPLICIT', 'frequency_default_value': 0.0, 'frequency_normalized': True, 'role': 'REJECT', 'type': 'CATEGORY', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'Text'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'prenom': {'category_handling': 'DUMMIFY', 'missing_handling': 'NONE', 'missing_impute_with': 'MODE', 'dummy_clip': 'MAX_NB_CATEGORIES', 'cumulative_proportion': 0.95, 'min_samples': 10, 'max_nb_categories': 100, 'max_cat_safety': 200, 'nb_bins_hashing': 1048576, 'hash_whole_categories': True, 'dummy_drop': 'NONE', 'impact_method': 'M_ESTIMATOR', 'impact_m': 10, 'impact_kfold': True, 'impact_kfold_k': 5, 'impact_kfold_seed': 1337, 'ordinal_order': 'COUNT', 'ordinal_ascending': False, 'ordinal_default_mode': 'HIGHEST', 'ordinal_default_value': 0, 'frequency_default_mode': 'EXPLICIT', 'frequency_default_value': 0.0, 'frequency_normalized': True, 'role': 'REJECT', 'type': 'CATEGORY', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'Text'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'client_id': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEDIAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'autoReason': 'REJECT_IDENTIFIER', 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'nbre_contrat_investi': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}}, 'reduce': {'enabled': False, 'kept_variance': 0.0}, 'feature_generation': {'pairwise_linear': {'behavior': 'DISABLED'}, 'polynomial_combinations': {'behavior': 'DISABLED'}, 'manual_interactions': {'interactions': [{'column_1': 'rang_investisseur', 'column_2': 'nbre_contrat_investi', 'max_features': 100, 'rescale': True}]}, 'numericals_clustering': {'k': 0, 'all_features': False, 'input_features': [], 'behavior': 'DISABLED'}, 'categoricals_count_transformer': {'all_features': False, 'input_features': [], 'behavior': 'DISABLED'}}}
[2025-08-19 21:14:13,180] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] No feature selection to perform
[2025-08-19 21:14:13,181] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] END -  Collecting statistics
[2025-08-19 21:14:13,182] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] START -  Preprocessing train set
[2025-08-19 21:14:13,262] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 346
[2025-08-19 21:14:13,263] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:RemapValueToOutput
[2025-08-19 21:14:13,263] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:13,264] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {'rang_investisseur': 173.5, 'client_id': 250.0, 'nbre_contrat_investi': 1.722543352601156}
[2025-08-19 21:14:13,265] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:13,265] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:13,266] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:RescalingProcessor2 (rang_investisseur)
[2025-08-19 21:14:13,267] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale rang_investisseur (avg=173.5 std=100.02582999738951 shift=173.5 inv_scale=0.009997417667277525 nulls=0)
[2025-08-19 21:14:13,270] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:RescalingProcessor2 (client_id)
[2025-08-19 21:14:13,272] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale client_id (avg=251.35838150289018 std=143.0183079462474 shift=251.35838150289018 inv_scale=0.00699211180974008 nulls=0)
[2025-08-19 21:14:13,273] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:RescalingProcessor2 (nbre_contrat_investi)
[2025-08-19 21:14:13,275] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale nbre_contrat_investi (avg=1.722543352601156 std=0.9438806143030668 shift=1.722543352601156 inv_scale=1.0594560210756845 nulls=0)
[2025-08-19 21:14:13,277] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:FlushDFBuilder(num_flagonly)
[2025-08-19 21:14:13,278] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:FlushDFBuilder(datetime_cyclical)
[2025-08-19 21:14:13,278] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:13,278] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:13,278] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:FlushDFBuilder(cat_flagpresence)
[2025-08-19 21:14:13,278] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:13,279] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:13,279] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:13,279] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:13,279] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:NumericalNumericalInteraction
[2025-08-19 21:14:13,281] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:FlushDFBuilder(interaction)
[2025-08-19 21:14:13,282] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:RealignTarget
[2025-08-19 21:14:13,283] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] Realign target series = (346,)
[2025-08-19 21:14:13,292] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] After realign target: (346,)
[2025-08-19 21:14:13,292] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:DropRowsWhereNoTarget
[2025-08-19 21:14:13,293] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] Deleting 0 rows because one of ['target'] is missing or infinity
[2025-08-19 21:14:13,294] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MF before = (346, 4)
[2025-08-19 21:14:13,294] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] target before = (346,)
[2025-08-19 21:14:13,296] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] MultiFrame, dropping rows: []
[2025-08-19 21:14:13,343] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] After DRWNT input_df=(346, 6)
[2025-08-19 21:14:13,343] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MF after = (346, 4)
[2025-08-19 21:14:13,343] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] target after = (346,)
[2025-08-19 21:14:13,344] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:DumpPipelineState
[2025-08-19 21:14:13,345] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] ********* Pipeline state (Before feature selection)
[2025-08-19 21:14:13,345] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    input_df= (346, 6) 
[2025-08-19 21:14:13,345] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    current_mf=(346, 4) 
[2025-08-19 21:14:13,345] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    PPR: 
[2025-08-19 21:14:13,345] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       target = <class 'pandas.core.series.Series'> ((346,))
[2025-08-19 21:14:13,345] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:EmitCurrentMFAsResult
[2025-08-19 21:14:13,346] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 346
[2025-08-19 21:14:13,346] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] FIT/PROCESS WITH Step:DumpPipelineState
[2025-08-19 21:14:13,346] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] ********* Pipeline state (At end)
[2025-08-19 21:14:13,346] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    input_df= (346, 6) 
[2025-08-19 21:14:13,346] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    current_mf=(0, 0) 
[2025-08-19 21:14:13,346] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    PPR: 
[2025-08-19 21:14:13,347] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       target = <class 'pandas.core.series.Series'> ((346,))
[2025-08-19 21:14:13,347] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       TRAIN = <class 'dataiku.doctor.multiframe.MultiFrame'> ((346, 4))
[2025-08-19 21:14:13,347] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       UNPROCESSED = <class 'pandas.core.frame.DataFrame'> ((346, 6))
[2025-08-19 21:14:13,347] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.modeling_parameters] train multiframe initial size: 346
[2025-08-19 21:14:13,356] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] END -  Preprocessing train set
[2025-08-19 21:14:13,356] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] START -  Preprocessing test set
[2025-08-19 21:14:13,408] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 346
[2025-08-19 21:14:13,408] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:RemapValueToOutput
[2025-08-19 21:14:13,409] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:13,409] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {'rang_investisseur': 173.5, 'client_id': 250.0, 'nbre_contrat_investi': 1.722543352601156}
[2025-08-19 21:14:13,411] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:13,411] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:13,411] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:RescalingProcessor2 (rang_investisseur)
[2025-08-19 21:14:13,412] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale rang_investisseur (avg=173.5 std=100.02582999738951 shift=173.5 inv_scale=0.009997417667277525 nulls=0)
[2025-08-19 21:14:13,414] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:RescalingProcessor2 (client_id)
[2025-08-19 21:14:13,415] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale client_id (avg=251.35838150289018 std=143.0183079462474 shift=251.35838150289018 inv_scale=0.00699211180974008 nulls=0)
[2025-08-19 21:14:13,420] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:RescalingProcessor2 (nbre_contrat_investi)
[2025-08-19 21:14:13,421] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale nbre_contrat_investi (avg=1.722543352601156 std=0.9438806143030668 shift=1.722543352601156 inv_scale=1.0594560210756845 nulls=0)
[2025-08-19 21:14:13,421] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(num_flagonly)
[2025-08-19 21:14:13,422] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(datetime_cyclical)
[2025-08-19 21:14:13,422] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:13,423] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:13,423] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(cat_flagpresence)
[2025-08-19 21:14:13,423] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:13,424] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:13,424] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:13,424] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:13,424] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:NumericalNumericalInteraction
[2025-08-19 21:14:13,425] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(interaction)
[2025-08-19 21:14:13,427] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:RealignTarget
[2025-08-19 21:14:13,427] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] Realign target series = (346,)
[2025-08-19 21:14:13,428] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] After realign target: (346,)
[2025-08-19 21:14:13,429] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:DropRowsWhereNoTarget
[2025-08-19 21:14:13,472] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] Deleting 0 rows because one of ['target'] is missing or infinity
[2025-08-19 21:14:13,472] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MF before = (346, 4)
[2025-08-19 21:14:13,472] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] target before = (346,)
[2025-08-19 21:14:13,474] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] MultiFrame, dropping rows: []
[2025-08-19 21:14:13,477] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] After DRWNT input_df=(346, 6)
[2025-08-19 21:14:13,477] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MF after = (346, 4)
[2025-08-19 21:14:13,477] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] target after = (346,)
[2025-08-19 21:14:13,477] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:DumpPipelineState
[2025-08-19 21:14:13,478] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] ********* Pipeline state (Before feature selection)
[2025-08-19 21:14:13,478] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    input_df= (346, 6) 
[2025-08-19 21:14:13,478] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    current_mf=(346, 4) 
[2025-08-19 21:14:13,478] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    PPR: 
[2025-08-19 21:14:13,479] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       target = <class 'pandas.core.series.Series'> ((346,))
[2025-08-19 21:14:13,479] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:EmitCurrentMFAsResult
[2025-08-19 21:14:13,479] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 346
[2025-08-19 21:14:13,479] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:DumpPipelineState
[2025-08-19 21:14:13,479] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] ********* Pipeline state (At end)
[2025-08-19 21:14:13,479] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    input_df= (346, 6) 
[2025-08-19 21:14:13,480] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    current_mf=(0, 0) 
[2025-08-19 21:14:13,480] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    PPR: 
[2025-08-19 21:14:13,480] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       target = <class 'pandas.core.series.Series'> ((346,))
[2025-08-19 21:14:13,480] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       TRAIN = <class 'dataiku.doctor.multiframe.MultiFrame'> ((346, 4))
[2025-08-19 21:14:13,480] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       UNPROCESSED = <class 'pandas.core.frame.DataFrame'> ((346, 6))
[2025-08-19 21:14:13,480] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.modeling_parameters] test multiframe initial size: 346
[2025-08-19 21:14:13,482] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] END -  Preprocessing test set
[2025-08-19 21:14:13,521] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] START -  Fitting model
[2025-08-19 21:14:13,578] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common] NaN support unavailable: incompatible algorithm DECISION_TREE_REGRESSION on scikit-learn==1.3.2
[2025-08-19 21:14:13,578] [11384/MainThread] [INFO] [dataiku.doctor.sparse] Algorithm DECISION_TREE_REGRESSION doesn't support sparse matrices, using NPA
[2025-08-19 21:14:13,579] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common] Create CLF from params: {'algorithm': 'DECISION_TREE_REGRESSION', 'dtc_classifier_grid': {'max_depth': {'gridMode': 'EXPLICIT', 'randomMode': 'RANGE', 'limit': {'min': 1}, 'values': [5], 'range': {'min': 3, 'max': 10, 'nbValues': 3, 'scaling': 'LINEAR'}}, 'min_samples_leaf': {'gridMode': 'EXPLICIT', 'randomMode': 'RANGE', 'limit': {'min': 1}, 'values': [1], 'range': {'min': 1, 'max': 20, 'nbValues': 3, 'scaling': 'LINEAR'}}, 'criterion': {'values': {'entropy': {'enabled': False}, 'gini': {'enabled': True}}}, 'splitter': {'values': {'best': {'enabled': True}, 'random': {'enabled': False}}}, 'enabled': True}, 'max_ensemble_nodes_serialized': 0, 'metrics': {'customMetrics': [], 'evaluationMetric': 'R2', 'classAveragingMethod': 'MACRO', 'costMatrixWeights': {'tpGain': 1.0, 'tnGain': 0.0, 'fpGain': -0.3, 'fnGain': 0.0}, 'liftPoint': 0.4, 'netUpliftPoint': 0.5, 'causalWeighting': 'NO_WEIGHTING'}, 'autoOptimizeThreshold': True, 'forcedClassifierThreshold': 0.0, 'gridLength': 1, 'grid_search_params': {'mode': 'KFOLD', 'splitRatio': 0.8, 'shuffleIterations': 1, 'nFolds': 5, 'cvSeed': 1337, 'stratified': True, 'grouped': False, 'strategy': 'GRID', 'bayesianOptimizer': 'SCIKIT_OPTIMIZE', 'randomized': True, 'seed': 1337, 'nIter': 0, 'nIterRandom': 3, 'timeout': 0, 'nJobs': 4, 'distributed': False, 'nContainers': 4, 'foldOffset': True, 'equalDurationFolds': False}, 'pluginAlgoCustomGridSearch': False, 'computeLearningCurves': False, 'skipExpensiveReports': False, 'propensityModeling': {'enabled': True, 'calibrateProbabilities': False, 'calibrationDataRatio': 0.1}} for algorithm DECISION_TREE_REGRESSION
[2025-08-19 21:14:13,579] [11384/MainThread] [WARNING] [dataiku.doctor.prediction.common] Stratified k-fold CV can only be used with classification models. Falling back to non-stratified k-fold CV.
[2025-08-19 21:14:13,580] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common] Using K-Fold CV with k=5
[2025-08-19 21:14:13,630] [11384/MainThread] [INFO] [dataiku.doctor.crossval.search_evaluation_monitor] No distributed container configuration is available to run this search
[2025-08-19 21:14:13,631] [11384/MainThread] [INFO] [dataiku.doctor.crossval.search_runner] Got single-point space, not performing hyperparameter search
[2025-08-19 21:14:13,631] [11384/MainThread] [INFO] [dataiku.doctor.crossval.strategies.grid_search_strategy] Running GridSearchStrategy for hyperparameters space: <dataiku.doctor.prediction.common.HyperparametersSpace object at 0x000001B3F28097D0>
[2025-08-19 21:14:13,632] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common] Fitting model:
[2025-08-19 21:14:13,637] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common]   Model is: DecisionTreeRegressor(max_depth=5, random_state=1337)
[2025-08-19 21:14:13,637] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common]   train_X class: <class 'numpy.ndarray'>
[2025-08-19 21:14:13,638] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common]   train_X shape: (346, 4)
[2025-08-19 21:14:13,638] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common]   train_y shape: (346,)
[2025-08-19 21:14:13,645] [11384/MainThread] [INFO] [dataiku.doctor.prediction.regression_fit] DT params are {'ccp_alpha': 0.0, 'criterion': 'squared_error', 'max_depth': 5, 'max_features': None, 'max_leaf_nodes': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'random_state': 1337, 'splitter': 'best'} 
[2025-08-19 21:14:13,646] [11384/MainThread] [INFO] [dataiku.doctor.prediction.regression_fit] Output params are {'resolved': {'algorithm': 'DECISION_TREE_REGRESSION', 'skipExpensiveReports': False, 'dt': {'max_depth': 5, 'criterion': 'squared_error', 'min_samples_leaf': 1, 'splitter': 'best'}}, 'other': {}}
[2025-08-19 21:14:13,646] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] Adding diagnostic: <DoctorDiagnostic ML_DIAGNOSTICS_LEAKAGE_DETECTION: Feature "rang_investisseur" has suspiciously high importance: 99%, which could be indicative of data leakage or overfitting>
[2025-08-19 21:14:13,648] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] END -  Fitting model
[2025-08-19 21:14:13,648] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] START -  Saving model
[2025-08-19 21:14:13,913] [11384/MainThread] [INFO] [dataiku.base.dku_pickle] Setting cloudpickle as the pickle dumping tool
[2025-08-19 21:14:13,928] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] END -  Saving model
[2025-08-19 21:14:13,928] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] START -  Scoring model
[2025-08-19 21:14:13,961] [11384/MainThread] [INFO] [dataiku.doctor.prediction.regression_scoring] Intrinsic scoring
[2025-08-19 21:14:13,961] [11384/MainThread] [INFO] [dataiku.doctor.prediction.regression_scoring] Extracting rescalers
[2025-08-19 21:14:13,961] [11384/MainThread] [INFO] [dataiku.doctor.prediction.regression_scoring] Creating decision tree summary
[2025-08-19 21:14:13,967] [11384/MainThread] [INFO] [dataiku.doctor.prediction.regression_scoring] Computing DT PDP
C:\Users\Admin\AppData\Local\Dataiku\DataScienceStudio\kits\dataiku-dss-14.1.0-win\pythonwin.packages\sklearn\utils\_bunch.py:35: FutureWarning: Key: 'values', is deprecated in 1.3 and will be removed in 1.5. Please use 'grid_values' instead.
  warnings.warn(
[2025-08-19 21:14:13,996] [11384/MainThread] [INFO] [dataiku.doctor.prediction.scoring_base] Computing feature importance
[2025-08-19 21:14:13,996] [11384/MainThread] [INFO] [dataiku.doctor.prediction.linear_coefficients_computation] Not computing linear coefficients because attribute `coef_` is not present
[2025-08-19 21:14:14,004] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common] NaN support unavailable: incompatible algorithm DECISION_TREE_REGRESSION on scikit-learn==1.3.2
[2025-08-19 21:14:14,004] [11384/MainThread] [INFO] [dataiku.doctor.sparse] Algorithm DECISION_TREE_REGRESSION doesn't support sparse matrices, using NPA
[2025-08-19 21:14:14,004] [11384/MainThread] [INFO] [dataiku.doctor.prediction.regression_scoring] Creating predictions on test set
[2025-08-19 21:14:14,005] [11384/MainThread] [INFO] [dataiku.doctor.prediction.regression_scoring] Computing regression performance
C:\Users\Admin\AppData\Local\Dataiku\DataScienceStudio\kits\dataiku-dss-14.1.0-win\python\dataiku\doctor\prediction\regression_scoring.py:452: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  ags = results.groupby('error_bin_id')['target'].count().reset_index()
[2025-08-19 21:14:14,029] [11384/MainThread] [INFO] [dataiku.doctor.prediction.regression_scoring] Computing residuals
[2025-08-19 21:14:14,037] [11384/MainThread] [INFO] [dataiku.doctor.prediction.regression_scoring] Computing scatter plot
C:\Users\Admin\AppData\Local\Dataiku\DataScienceStudio\kits\dataiku-dss-14.1.0-win\python\dataiku\doctor\prediction\regression_scoring.py:118: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  return correlation['predicted'][1]
[2025-08-19 21:14:14,158] [11384/MainThread] [INFO] [dataiku.doctor.diagnostics.diagnostics] Adding diagnostic: <DoctorDiagnostic ML_DIAGNOSTICS_LEAKAGE_DETECTION: R2 Score=0.999, too good to be true?>
[2025-08-19 21:14:14,160] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] END -  Scoring model
[2025-08-19 21:14:14,160] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] START -  Preparing explainability
[2025-08-19 21:14:14,182] [11384/MainThread] [INFO] [dataiku.doctor.prediction_entrypoints] Starting to compute global explanations
[2025-08-19 21:14:14,182] [11384/MainThread] [INFO] [dataiku.doctor.prediction_entrypoints] Building model handler
[2025-08-19 21:14:14,206] [11384/MainThread] [INFO] [dataiku.doctor.utils.gpu_execution] Not logging `nvidia-smi`: `useGPU` is False
[2025-08-19 21:14:14,222] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common] NaN support unavailable: incompatible algorithm DECISION_TREE_REGRESSION on scikit-learn==1.3.2
[2025-08-19 21:14:14,241] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] generating interactions
[2025-08-19 21:14:14,241] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] generating : rang_investisseur x nbre_contrat_investi
[2025-08-19 21:14:14,241] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] {'feature_selection_params': {'method': 'NONE', 'random_forest_params': {'n_trees': 30, 'depth': 10, 'n_features': 25}, 'lasso_params': {'alpha': [0.01, 0.1, 1.0, 10.0, 100.0], 'cross_validate': True}, 'pca_params': {'n_features': 25, 'variance_proportion': 0.9}, 'correlation_params': {'min_abs_correlation': 0.0, 'max_abs_correlation': 1.0, 'n_features': 25}, 'custom_params': {'code': '# type your code here'}}, 'preprocessingFitSampleRatio': 1.0, 'preprocessingFitSampleSeed': 1337, 'target_remapping': [], 'skipPreprocessing': False, 'per_feature': {'total_investi': {'generate_derivative': False, 'impute_constant_value': 0.0, 'keep_regular': False, 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'TARGET', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'DoubleMeaning'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'rang_investisseur': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEDIAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'autoReason': 'REJECT_IDENTIFIER', 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'nom': {'category_handling': 'DUMMIFY', 'missing_handling': 'NONE', 'missing_impute_with': 'MODE', 'dummy_clip': 'MAX_NB_CATEGORIES', 'cumulative_proportion': 0.95, 'min_samples': 10, 'max_nb_categories': 100, 'max_cat_safety': 200, 'nb_bins_hashing': 1048576, 'hash_whole_categories': True, 'dummy_drop': 'NONE', 'impact_method': 'M_ESTIMATOR', 'impact_m': 10, 'impact_kfold': True, 'impact_kfold_k': 5, 'impact_kfold_seed': 1337, 'ordinal_order': 'COUNT', 'ordinal_ascending': False, 'ordinal_default_mode': 'HIGHEST', 'ordinal_default_value': 0, 'frequency_default_mode': 'EXPLICIT', 'frequency_default_value': 0.0, 'frequency_normalized': True, 'role': 'REJECT', 'type': 'CATEGORY', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'Text'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'prenom': {'category_handling': 'DUMMIFY', 'missing_handling': 'NONE', 'missing_impute_with': 'MODE', 'dummy_clip': 'MAX_NB_CATEGORIES', 'cumulative_proportion': 0.95, 'min_samples': 10, 'max_nb_categories': 100, 'max_cat_safety': 200, 'nb_bins_hashing': 1048576, 'hash_whole_categories': True, 'dummy_drop': 'NONE', 'impact_method': 'M_ESTIMATOR', 'impact_m': 10, 'impact_kfold': True, 'impact_kfold_k': 5, 'impact_kfold_seed': 1337, 'ordinal_order': 'COUNT', 'ordinal_ascending': False, 'ordinal_default_mode': 'HIGHEST', 'ordinal_default_value': 0, 'frequency_default_mode': 'EXPLICIT', 'frequency_default_value': 0.0, 'frequency_normalized': True, 'role': 'REJECT', 'type': 'CATEGORY', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'Text'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'client_id': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEDIAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'autoReason': 'REJECT_IDENTIFIER', 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'nbre_contrat_investi': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}}, 'reduce': {'enabled': False, 'kept_variance': 0.0}, 'feature_generation': {'pairwise_linear': {'behavior': 'DISABLED'}, 'polynomial_combinations': {'behavior': 'DISABLED'}, 'manual_interactions': {'interactions': [{'column_1': 'rang_investisseur', 'column_2': 'nbre_contrat_investi', 'max_features': 100, 'rescale': True}]}, 'numericals_clustering': {'k': 0, 'all_features': False, 'input_features': [], 'behavior': 'DISABLED'}, 'categoricals_count_transformer': {'all_features': False, 'input_features': [], 'behavior': 'DISABLED'}}}
[2025-08-19 21:14:14,242] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] No feature selection to perform
[2025-08-19 21:14:14,288] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] generating interactions
[2025-08-19 21:14:14,288] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] generating : rang_investisseur x nbre_contrat_investi
[2025-08-19 21:14:14,289] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] {'feature_selection_params': {'method': 'NONE', 'random_forest_params': {'n_trees': 30, 'depth': 10, 'n_features': 25}, 'lasso_params': {'alpha': [0.01, 0.1, 1.0, 10.0, 100.0], 'cross_validate': True}, 'pca_params': {'n_features': 25, 'variance_proportion': 0.9}, 'correlation_params': {'min_abs_correlation': 0.0, 'max_abs_correlation': 1.0, 'n_features': 25}, 'custom_params': {'code': '# type your code here'}}, 'preprocessingFitSampleRatio': 1.0, 'preprocessingFitSampleSeed': 1337, 'target_remapping': [], 'skipPreprocessing': False, 'per_feature': {'total_investi': {'generate_derivative': False, 'impute_constant_value': 0.0, 'keep_regular': False, 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'TARGET', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'DoubleMeaning'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'rang_investisseur': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEDIAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'autoReason': 'REJECT_IDENTIFIER', 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'nom': {'category_handling': 'DUMMIFY', 'missing_handling': 'NONE', 'missing_impute_with': 'MODE', 'dummy_clip': 'MAX_NB_CATEGORIES', 'cumulative_proportion': 0.95, 'min_samples': 10, 'max_nb_categories': 100, 'max_cat_safety': 200, 'nb_bins_hashing': 1048576, 'hash_whole_categories': True, 'dummy_drop': 'NONE', 'impact_method': 'M_ESTIMATOR', 'impact_m': 10, 'impact_kfold': True, 'impact_kfold_k': 5, 'impact_kfold_seed': 1337, 'ordinal_order': 'COUNT', 'ordinal_ascending': False, 'ordinal_default_mode': 'HIGHEST', 'ordinal_default_value': 0, 'frequency_default_mode': 'EXPLICIT', 'frequency_default_value': 0.0, 'frequency_normalized': True, 'role': 'REJECT', 'type': 'CATEGORY', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'Text'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'prenom': {'category_handling': 'DUMMIFY', 'missing_handling': 'NONE', 'missing_impute_with': 'MODE', 'dummy_clip': 'MAX_NB_CATEGORIES', 'cumulative_proportion': 0.95, 'min_samples': 10, 'max_nb_categories': 100, 'max_cat_safety': 200, 'nb_bins_hashing': 1048576, 'hash_whole_categories': True, 'dummy_drop': 'NONE', 'impact_method': 'M_ESTIMATOR', 'impact_m': 10, 'impact_kfold': True, 'impact_kfold_k': 5, 'impact_kfold_seed': 1337, 'ordinal_order': 'COUNT', 'ordinal_ascending': False, 'ordinal_default_mode': 'HIGHEST', 'ordinal_default_value': 0, 'frequency_default_mode': 'EXPLICIT', 'frequency_default_value': 0.0, 'frequency_normalized': True, 'role': 'REJECT', 'type': 'CATEGORY', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'Text'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'client_id': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEDIAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'autoReason': 'REJECT_IDENTIFIER', 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}, 'nbre_contrat_investi': {'generate_derivative': False, 'numerical_handling': 'REGULAR', 'missing_handling': 'IMPUTE', 'missing_impute_with': 'MEAN', 'impute_constant_value': 0.0, 'keep_regular': False, 'rescaling': 'AVGSTD', 'monotonic': 'NONE', 'quantile_bin_nb_bins': 4, 'binarize_threshold_mode': 'MEDIAN', 'binarize_constant_threshold': 0.0, 'datetime_cyclical_periods': [], 'role': 'INPUT', 'type': 'NUMERIC', 'state': {'userModified': False, 'autoModifiedByDSS': False, 'recordedMeaning': 'LongMeaning'}, 'customHandlingCode': '', 'customProcessorWantsMatrix': False, 'sendToInput': 'main'}}, 'reduce': {'enabled': False, 'kept_variance': 0.0}, 'feature_generation': {'pairwise_linear': {'behavior': 'DISABLED'}, 'polynomial_combinations': {'behavior': 'DISABLED'}, 'manual_interactions': {'interactions': [{'column_1': 'rang_investisseur', 'column_2': 'nbre_contrat_investi', 'max_features': 100, 'rescale': True}]}, 'numericals_clustering': {'k': 0, 'all_features': False, 'input_features': [], 'behavior': 'DISABLED'}, 'categoricals_count_transformer': {'all_features': False, 'input_features': [], 'behavior': 'DISABLED'}}}
[2025-08-19 21:14:14,289] [11384/MainThread] [INFO] [dataiku.doctor.preprocessing_handler] No feature selection to perform
[2025-08-19 21:14:14,290] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 1
[2025-08-19 21:14:14,291] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:14,291] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {'rang_investisseur': 173.5, 'client_id': 250.0, 'nbre_contrat_investi': 1.722543352601156}
[2025-08-19 21:14:14,293] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:14,293] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:14,293] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:RescalingProcessor2 (rang_investisseur)
[2025-08-19 21:14:14,294] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale rang_investisseur (avg=173.5 std=nan shift=173.5 inv_scale=0.009997417667277525 nulls=0)
[2025-08-19 21:14:14,295] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:RescalingProcessor2 (client_id)
[2025-08-19 21:14:14,295] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale client_id (avg=251.35838150289018 std=nan shift=251.35838150289018 inv_scale=0.00699211180974008 nulls=0)
[2025-08-19 21:14:14,296] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:RescalingProcessor2 (nbre_contrat_investi)
[2025-08-19 21:14:14,297] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale nbre_contrat_investi (avg=1.722543352601156 std=nan shift=1.722543352601156 inv_scale=1.0594560210756845 nulls=0)
[2025-08-19 21:14:14,298] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(num_flagonly)
[2025-08-19 21:14:14,298] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(datetime_cyclical)
[2025-08-19 21:14:14,298] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:14,298] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:14,298] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(cat_flagpresence)
[2025-08-19 21:14:14,298] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:14,298] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:14,299] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:14,299] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:14,299] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:NumericalNumericalInteraction
[2025-08-19 21:14:14,300] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(interaction)
[2025-08-19 21:14:14,302] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:DumpPipelineState
[2025-08-19 21:14:14,302] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] ********* Pipeline state (Before feature selection)
[2025-08-19 21:14:14,302] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    input_df= (1, 6) 
[2025-08-19 21:14:14,302] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    current_mf=(1, 4) 
[2025-08-19 21:14:14,303] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    PPR: 
[2025-08-19 21:14:14,303] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:EmitCurrentMFAsResult
[2025-08-19 21:14:14,303] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 1
[2025-08-19 21:14:14,303] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:DumpPipelineState
[2025-08-19 21:14:14,303] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] ********* Pipeline state (At end)
[2025-08-19 21:14:14,303] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    input_df= (1, 6) 
[2025-08-19 21:14:14,304] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    current_mf=(0, 0) 
[2025-08-19 21:14:14,304] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    PPR: 
[2025-08-19 21:14:14,304] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       TRAIN = <class 'dataiku.doctor.multiframe.MultiFrame'> ((1, 4))
[2025-08-19 21:14:14,304] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       UNPROCESSED = <class 'pandas.core.frame.DataFrame'> ((1, 6))
[2025-08-19 21:14:14,304] [11384/MainThread] [INFO] [dataiku.doctor.individual_explainer] Preparing explainer components: column importance, background rows and feature histograms
[2025-08-19 21:14:14,305] [11384/MainThread] [INFO] [dataiku.doctor.individual_explainer] Loading train dataset to allow for computation of explanations.
[2025-08-19 21:14:14,305] [11384/MainThread] [INFO] [root] Reading with dtypes: None
[2025-08-19 21:14:14,305] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for client_id: <class 'numpy.float64'> (schema_type=bigint feature_type=NUMERIC feature_role=INPUT)
[2025-08-19 21:14:14,306] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for nom: None (schema_type=string feature_type=CATEGORY feature_role=REJECT)
[2025-08-19 21:14:14,306] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for prenom: None (schema_type=string feature_type=CATEGORY feature_role=REJECT)
[2025-08-19 21:14:14,306] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for nbre_contrat_investi: <class 'numpy.float64'> (schema_type=bigint feature_type=NUMERIC feature_role=INPUT)
[2025-08-19 21:14:14,306] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for total_investi: <class 'numpy.float64'> (schema_type=double feature_type=NUMERIC feature_role=TARGET)
[2025-08-19 21:14:14,306] [11384/MainThread] [INFO] [dataiku.doctor.utils] Computed dtype for rang_investisseur: <class 'numpy.float64'> (schema_type=bigint feature_type=NUMERIC feature_role=INPUT)
[2025-08-19 21:14:14,307] [11384/MainThread] [INFO] [root] Reading with FIXED dtypes: {'client_id': <class 'numpy.float64'>, 'nbre_contrat_investi': <class 'numpy.float64'>, 'total_investi': <class 'numpy.float64'>, 'rang_investisseur': <class 'numpy.float64'>}
[2025-08-19 21:14:14,315] [11384/MainThread] [INFO] [root] Loaded table
[2025-08-19 21:14:14,315] [11384/MainThread] [INFO] [dataiku.doctor.utils] Coercion done
[2025-08-19 21:14:14,316] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 346
[2025-08-19 21:14:14,316] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:14,316] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {'rang_investisseur': 173.5, 'client_id': 250.0, 'nbre_contrat_investi': 1.722543352601156}
[2025-08-19 21:14:14,319] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:14,319] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:14,319] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:RescalingProcessor2 (rang_investisseur)
[2025-08-19 21:14:14,320] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale rang_investisseur (avg=173.5 std=100.02582999738951 shift=173.5 inv_scale=0.009997417667277525 nulls=0)
[2025-08-19 21:14:14,321] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:RescalingProcessor2 (client_id)
[2025-08-19 21:14:14,321] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale client_id (avg=251.35838150289018 std=143.0183079462474 shift=251.35838150289018 inv_scale=0.00699211180974008 nulls=0)
[2025-08-19 21:14:14,322] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:RescalingProcessor2 (nbre_contrat_investi)
[2025-08-19 21:14:14,323] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]   Rescale nbre_contrat_investi (avg=1.722543352601156 std=0.9438806143030668 shift=1.722543352601156 inv_scale=1.0594560210756845 nulls=0)
[2025-08-19 21:14:14,325] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(num_flagonly)
[2025-08-19 21:14:14,325] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(datetime_cyclical)
[2025-08-19 21:14:14,325] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:14,325] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:14,325] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(cat_flagpresence)
[2025-08-19 21:14:14,325] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:14,325] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:14,325] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:MultipleImputeMissingFromInput
[2025-08-19 21:14:14,325] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] MIMIFI: Imputing with map {}
[2025-08-19 21:14:14,325] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:NumericalNumericalInteraction
[2025-08-19 21:14:14,326] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:FlushDFBuilder(interaction)
[2025-08-19 21:14:14,327] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:DumpPipelineState
[2025-08-19 21:14:14,327] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] ********* Pipeline state (Before feature selection)
[2025-08-19 21:14:14,327] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    input_df= (346, 6) 
[2025-08-19 21:14:14,327] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    current_mf=(346, 4) 
[2025-08-19 21:14:14,327] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    PPR: 
[2025-08-19 21:14:14,328] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:EmitCurrentMFAsResult
[2025-08-19 21:14:14,328] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 346
[2025-08-19 21:14:14,328] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] PROCESS WITH Step:DumpPipelineState
[2025-08-19 21:14:14,328] [11384/MainThread] [DEBUG] [dku.ml.preprocessing] ********* Pipeline state (At end)
[2025-08-19 21:14:14,328] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    input_df= (346, 6) 
[2025-08-19 21:14:14,328] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    current_mf=(0, 0) 
[2025-08-19 21:14:14,329] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]    PPR: 
[2025-08-19 21:14:14,329] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       TRAIN = <class 'dataiku.doctor.multiframe.MultiFrame'> ((346, 4))
[2025-08-19 21:14:14,329] [11384/MainThread] [DEBUG] [dku.ml.preprocessing]       UNPROCESSED = <class 'pandas.core.frame.DataFrame'> ((346, 6))
[2025-08-19 21:14:14,329] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common] NaN support unavailable: incompatible algorithm DECISION_TREE_REGRESSION on scikit-learn==1.3.2
[2025-08-19 21:14:14,330] [11384/MainThread] [INFO] [dataiku.doctor.sparse] Algorithm DECISION_TREE_REGRESSION doesn't support sparse matrices, using NPA
[2025-08-19 21:14:14,355] [11384/MainThread] [INFO] [dataiku.doctor.prediction.column_importance_handler] Reusing the model feature importance
[2025-08-19 21:14:14,357] [11384/MainThread] [INFO] [dataiku.doctor.prediction.column_importance_handler] Saving column importance
[2025-08-19 21:14:14,363] [11384/MainThread] [INFO] [dataiku.doctor.prediction.background_rows_handler] Building background rows
[2025-08-19 21:14:14,367] [11384/MainThread] [INFO] [dataiku.doctor.prediction.background_rows_handler] Background estimated bias <= 0.5037769589937398
[2025-08-19 21:14:14,372] [11384/MainThread] [INFO] [dataiku.doctor.prediction.background_rows_handler] Built background rows with shape=(346, 6)
[2025-08-19 21:14:14,373] [11384/MainThread] [INFO] [dataiku.doctor.prediction.background_rows_handler] Saving background rows with shape=(346, 6)
[2025-08-19 21:14:14,379] [11384/MainThread] [INFO] [dataiku.doctor.utils] Coercion done
[2025-08-19 21:14:14,381] [11384/MainThread] [INFO] [dataiku.doctor.posttraining.features_distribution] Computing features distribution
[2025-08-19 21:14:14,403] [11384/MainThread] [INFO] [dataiku.doctor.posttraining.features_distribution] Saving features distribution
[2025-08-19 21:14:14,422] [11384/MainThread] [INFO] [dataiku.doctor.individual_explainer] Feature interaction:rang_investisseur:nbre_contrat_investi comes from multiple columns, no support for feature to column indices
[2025-08-19 21:14:14,422] [11384/MainThread] [INFO] [dataiku.doctor.individual_explainer] Features to column indices is not supported. Shapley from preprocessed is not supported
[2025-08-19 21:14:14,423] [11384/MainThread] [INFO] [dataiku.doctor.individual_explainer] Using default Shapley Engine, all mentions of cells are *prior* preprocessing
[2025-08-19 21:14:14,429] [11384/MainThread] [INFO] [dataiku.doctor.prediction.explanations.shapley] 900 cells will be generated by FrankensteinBuilder(total_num_columns=3, background_size=100, num_cols_to_explain=3) for each row
[2025-08-19 21:14:14,432] [11384/MainThread] [INFO] [dataiku.doctor.prediction.explanations.engine] Selecting batch size of: 150 (num_rows=1, max_num_batches=15, max_singly_processed_cells=300000, estimated_processed_cells=135000)
[2025-08-19 21:14:14,433] [11384/MainThread] [INFO] [dataiku.doctor.prediction.explanations.engine] Explaining 150 rows in 1 batches
[2025-08-19 21:14:14,434] [11384/MainThread] [INFO] [dataiku.doctor.prediction.explanations.engine] Explaining 150 rows (batch 1/1)
[2025-08-19 21:14:14,435] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 150
[2025-08-19 21:14:14,443] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 150
[2025-08-19 21:14:14,444] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common] NaN support unavailable: incompatible algorithm DECISION_TREE_REGRESSION on scikit-learn==1.3.2
[2025-08-19 21:14:14,444] [11384/MainThread] [INFO] [dataiku.doctor.sparse] Algorithm DECISION_TREE_REGRESSION doesn't support sparse matrices, using NPA
[2025-08-19 21:14:14,455] [11384/MainThread] [INFO] [dataiku.doctor.prediction.explanations.shapley] Built frankenstein of shape (45000, 3)
[2025-08-19 21:14:14,455] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 45000
[2025-08-19 21:14:14,471] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 45000
[2025-08-19 21:14:14,472] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common] NaN support unavailable: incompatible algorithm DECISION_TREE_REGRESSION on scikit-learn==1.3.2
[2025-08-19 21:14:14,472] [11384/MainThread] [INFO] [dataiku.doctor.sparse] Algorithm DECISION_TREE_REGRESSION doesn't support sparse matrices, using NPA
[2025-08-19 21:14:14,491] [11384/MainThread] [INFO] [dataiku.doctor.prediction.explanations.shapley] Built frankenstein of shape (45000, 3)
[2025-08-19 21:14:14,491] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 45000
[2025-08-19 21:14:14,506] [11384/MainThread] [INFO] [dataiku.doctor.multiframe] Set MF index len 45000
[2025-08-19 21:14:14,506] [11384/MainThread] [INFO] [dataiku.doctor.prediction.common] NaN support unavailable: incompatible algorithm DECISION_TREE_REGRESSION on scikit-learn==1.3.2
[2025-08-19 21:14:14,507] [11384/MainThread] [INFO] [dataiku.doctor.sparse] Algorithm DECISION_TREE_REGRESSION doesn't support sparse matrices, using NPA
[2025-08-19 21:14:14,524] [11384/MainThread] [INFO] [dataiku.doctor.prediction.explanations.engine] Done computing explanations
[2025-08-19 21:14:14,576] [11384/MainThread] [INFO] [dataiku.doctor.utils.listener] END -  Preparing explainability
[2025-08-19 21:14:14,579] [11384/MainThread] [INFO] [dataiku.base.socket_block_link] Client closed
[2025/08/19-21:14:14.579] [MRT-11135] [INFO] [dku.block.link.interaction]  - Check result for nullity exceptionIfNull=true result=not null
[2025/08/19-21:14:14.592] [MRT-11135] [INFO] [dku.analysis.prediction]  - Training returned ok
[2025/08/19-21:14:14.605] [MRT-11135] [INFO] [dku.ml.versioning]  - Dumping version info {"trainedWithDSSVersion":"14.1.0","trainedWithDSSConfVersion":"14100","trainedWithDSSBackend":"PY_MEMORY","backendCompatibilityVersion":18} in C:\Users\Admin\AppData\Local\Dataiku\DataScienceStudio\dss_home\analysis-data\ASSURANCE_VIE_RISQUE\nQ8Qxe5O\Xyh2Ok65\sessions\s7\pp2\m1
[2025/08/19-21:14:14.692] [MRT-11135] [INFO] [dku.analysis.ml]  - preTrain={
  "algorithm": "DECISION_TREE_REGRESSION",
  "dtc_classifier_grid": {
    "max_depth": {
      "gridMode": "EXPLICIT",
      "randomMode": "RANGE",
      "limit": {
        "min": 1
      },
      "values": [
        5
      ],
      "range": {
        "min": 3,
        "max": 10,
        "nbValues": 3,
        "scaling": "LINEAR"
      }
    },
    "min_samples_leaf": {
      "gridMode": "EXPLICIT",
      "randomMode": "RANGE",
      "limit": {
        "min": 1
      },
      "values": [
        1
      ],
      "range": {
        "min": 1,
        "max": 20,
        "nbValues": 3,
        "scaling": "LINEAR"
      }
    },
    "criterion": {
      "values": {
        "entropy": {
          "enabled": false
        },
        "gini": {
          "enabled": true
        }
      }
    },
    "splitter": {
      "values": {
        "best": {
          "enabled": true
        },
        "random": {
          "enabled": false
        }
      }
    },
    "enabled": true
  },
  "max_ensemble_nodes_serialized": 0,
  "metrics": {
    "customMetrics": [],
    "evaluationMetric": "R2",
    "classAveragingMethod": "MACRO",
    "costMatrixWeights": {
      "tpGain": 1.0,
      "tnGain": 0.0,
      "fpGain": -0.3,
      "fnGain": 0.0
    },
    "liftPoint": 0.4,
    "netUpliftPoint": 0.5,
    "causalWeighting": "NO_WEIGHTING"
  },
  "autoOptimizeThreshold": true,
  "forcedClassifierThreshold": 0.0,
  "gridLength": 1,
  "grid_search_params": {
    "mode": "KFOLD",
    "splitRatio": 0.8,
    "shuffleIterations": 1,
    "nFolds": 5,
    "cvSeed": 1337,
    "stratified": true,
    "grouped": false,
    "strategy": "GRID",
    "bayesianOptimizer": "SCIKIT_OPTIMIZE",
    "randomized": true,
    "seed": 1337,
    "nIter": 0,
    "nIterRandom": 3,
    "timeout": 0,
    "nJobs": 4,
    "distributed": false,
    "nContainers": 4,
    "foldOffset": true,
    "equalDurationFolds": false
  },
  "pluginAlgoCustomGridSearch": false,
  "computeLearningCurves": false,
  "skipExpensiveReports": false,
  "propensityModeling": {
    "enabled": true,
    "calibrateProbabilities": false,
    "calibrationDataRatio": 0.1
  }
}
[2025/08/19-21:14:14.702] [MRT-11135] [INFO] [dku.analysis.ml]  - amp={
  "resolved": {
    "algorithm": "DECISION_TREE_REGRESSION",
    "dt": {
      "max_depth": 5,
      "criterion": "squared_error",
      "min_samples_leaf": 1,
      "splitter": "best"
    },
    "skipExpensiveReports": false
  },
  "other": {}
}
[2025/08/19-21:14:14.721] [MRT-11135] [WARN] [dku.kernels]  - Killing kernel python-single-command-kernel
[2025/08/19-21:14:14.733] [MRT-11135] [INFO] [dku.utils]  - Killing process PID: 17352
[2025/08/19-21:14:15.002] [KNL-python-single-command-kernel-monitor-11140] [INFO] [dku.kernels]  - Process done with code 1
[2025/08/19-21:14:15.014] [KNL-python-single-command-kernel-monitor-11140] [INFO] [dku.engine]  - Schedule closing for WorkerPool
[2025/08/19-21:14:15.025] [KNL-python-single-command-kernel-monitor-11140] [INFO] [dip.tickets]  - Destroying API ticket for analysis-ml-ASSURANCE_VIE_RISQUE-Q87Q7vz on behalf of admin
[2025/08/19-21:14:15.025] [AsyncCloser-20] [INFO] [com.dataiku.dip.analysis.ml.distributed.workers]  - Closing worker pool pool-tzy68l5gdgyakb5v
[2025/08/19-21:14:15.034] [KNL-python-single-command-kernel-monitor-11140] [DEBUG] [dku.resourceusage]  - Reporting completion of CRU:{"context":{"type":"ANALYSIS_ML_TRAIN","authIdentifier":"admin","projectKey":"ASSURANCE_VIE_RISQUE","analysisId":"nQ8Qxe5O","mlTaskId":"Xyh2Ok65","sessionId":"s7"},"type":"LOCAL_PROCESS","id":"oiU3zdwAjw70Z9IY","startTime":1755630842824,"localProcess":{"pid":17352,"commandName":"C:\\Users\\Admin\\AppData\\Local\\Dataiku\\DataScienceStudio\\dss_home\\pyenv\\Scripts\\python.exe","cpuCurrent":0.0,"cpuAverageOverPast60Seconds":0.0,"vmRSSTotalMBS":0}}
[2025/08/19-21:14:15.044] [AsyncCloser-20] [INFO] [com.dataiku.dip.analysis.ml.distributed.workers]  - Unregistered worker pool: pool-tzy68l5gdgyakb5v
[2025/08/19-21:14:15.055] [MRT-11135] [INFO] [dku.block.link]  - Closed socket
[2025/08/19-21:14:15.071] [MRT-11135] [INFO] [dku.block.link]  - Closed socket
[2025/08/19-21:14:15.062] [AsyncCloser-20] [INFO] [dku.engine]  - Successfully closed WorkerPool
[2025/08/19-21:14:15.080] [MRT-11135] [INFO] [dku.block.link]  - Closed serverSocket
[2025/08/19-21:14:24.776] [AsyncCloser-20] [INFO] [com.dataiku.dip.analysis.ml.distributed.workers]  - Closing worker pool pool-r22chrewnipx1mb9
[2025/08/19-21:14:24.793] [AsyncCloser-20] [INFO] [com.dataiku.dip.analysis.ml.distributed.workers]  - Unregistered worker pool: pool-r22chrewnipx1mb9
[2025/08/19-21:14:24.813] [AsyncCloser-20] [INFO] [dku.engine]  - Successfully closed WorkerPool
[2025/08/19-21:14:24.856] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.analysis.ml.python] T-Xyh2Ok65 - [ct: 23310] Processing thread joined ...
[2025/08/19-21:14:24.875] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.analysis.ml.python] T-Xyh2Ok65 - [ct: 23329] Joining processing thread ...
[2025/08/19-21:14:24.896] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.analysis.ml.python] T-Xyh2Ok65 - [ct: 23350] Processing thread joined ...
[2025/08/19-21:14:24.921] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.analysis] T-Xyh2Ok65 - [ct: 23375] Train done
[2025/08/19-21:14:24.954] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.analysis.prediction] T-Xyh2Ok65 - [ct: 23408] Train done
[2025/08/19-21:14:25.377] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.analysis.trainingdetails] T-Xyh2Ok65 - Publishing mltask-train-done reflected event
[2025/08/19-21:14:25.422] [FT-TrainWorkThread-V7M0TlMq-11133] [INFO] [dku.futures]  - [ct: 23876] Completed future execution: TrainWorkThread
